/* Fix: Ensure chart area and SVG are always visible and fill width on mobile */
@media (max-width: 900px) {
  main {
    flex-direction: column !important;
    gap: 0 !important;
  }
  #chartArea, svg#overviewChart {
    width: 100vw !important;
    min-width: 0 !important;
    max-width: 100vw !important;
    height: auto !important;
    min-height: 220px;
    margin: 0 auto 12px auto;
    overflow-x: auto;
  }
  /* Only show overviewChart if in overview view */
  body[data-view="overview"] #overviewChart {
    display: block !important;
  }
  body:not([data-view="overview"]) #overviewChart {
    display: none !important;
  }
}
/* Collapsible sidepanel for mobile */
@media (max-width: 900px) {
  #details.collapsed {
    max-height: 48px;
    overflow: hidden;
    width: 100vw !important;
    min-width: 0 !important;
    transition: max-height 0.3s;
    background: #181a20;
    border-radius: 0 0 12px 12px;
    box-shadow: 0 2px 8px #0002;
  }
  #details.collapsed > *:not(#toggleSidePanel) {
    display: none !important;
  }
  #toggleSidePanel {
    display: block;
    width: 100%;
    background: #23272e;
    color: #e6edf3;
    border: none;
    font-size: 1.1em;
    padding: 12px 0;
    border-radius: 0 0 12px 12px;
    cursor: pointer;
  }
}
/* Responsive base styles */
html, body {
  max-width: 100vw;
  overflow-x: hidden;
}

body {
  font-size: 1rem;
  line-height: 1.5;
  margin: 0;
  padding: 0;
}

main, .container, #overviewChart, #deepViewContainer, #artistTimelineContainer, #artistInfo {
  max-width: 100vw;
  box-sizing: border-box;
}

img, svg, canvas {
  max-width: 100%;
  height: auto;
  display: block;
}

input, button, select {
  font-size: 1em;
}

/* Make side panel and charts stack on mobile */
@media (max-width: 900px) {
  .main-flex, .container, #overviewChart, #deepViewContainer, #artistTimelineContainer, #artistInfo {
    flex-direction: column !important;
    width: 100% !important;
    max-width: 100vw !important;
    min-width: 0 !important;
  }
  #artistInfo, #deepViewContainer, #overviewChart, #artistTimelineContainer {
    padding: 0 2vw;
    margin: 0 auto 16px auto;
    width: 100% !important;
    min-width: 0 !important;
  }
  .side-panel, .sidepanel, .side {
    width: 100% !important;
    min-width: 0 !important;
    max-width: 100vw !important;
    margin: 0 auto 16px auto;
  }
  .chart-container, .d3-chart, .d3-container {
    width: 100% !important;
    min-width: 0 !important;
    max-width: 100vw !important;
    overflow-x: auto;
  }
  .sticky-player, #stickyPlayer {
    position: static !important;
    width: 100vw !important;
    left: 0 !important;
    right: 0 !important;
    margin: 0 auto 12px auto;
  }
  h1, h2, h3 {
    font-size: 1.2em;
  }
  .album-song-list, .song-list, .artist-list, .album-list {
    font-size: 1em;
  }
}

/* Touch-friendly buttons */
button, .button, input[type="button"], input[type="submit"] {
  min-height: 44px;
  min-width: 44px;
  padding: 10px 18px;
}

/* Make tables and lists scrollable on small screens */
@media (max-width: 600px) {
  table, .scrollable, .album-song-list, .song-list, .artist-list, .album-list {
    display: block;
    overflow-x: auto;
    white-space: nowrap;
    font-size: 0.98em;
  }
  h1, h2, h3 {
    font-size: 1.1em;
  }
}
/* Deep Dive Columns Layout */
.deep-dive-col { flex: 1 1 0; background: #161b22; border-radius: 6px; border: 1px solid #21262d; margin-bottom: 8px; padding: 8px 8px 8px 8px; min-width: 0; }
.deep-dive-col h3 { margin-top: 0; font-size: 1.05rem; border-bottom: 1px solid #21262d; padding-bottom: 4px; }

/* Album Monthly Breakdown */
.album-monthly-breakdown { display: flex; flex-wrap: wrap; gap: 12px; margin-top: 8px; }
.month-block { background: #21262d; border-radius: 4px; padding: 6px 10px; min-width: 120px; flex: 1 1 120px; }
.month-block ul { list-style: none; padding: 0; margin: 0; }
.month-block li { font-size: 0.95em; margin-bottom: 2px; display: flex; justify-content: space-between; }
.song-monthly-pct { columns: 2; -webkit-columns: 2; column-gap: 16px; list-style: none; padding: 0; margin: 0; }
.song-monthly-pct li { font-size: 0.95em; margin-bottom: 2px; }
/* Modal Styles */
.modal {
  position: fixed;
  z-index: 2000;
  left: 0; top: 0; width: 100vw; height: 100vh;
  background: rgba(13,17,23,0.85);
  display: flex; align-items: center; justify-content: center;
}
.modal-content {
  background: #161b22;
  padding: 32px 24px;
  border-radius: 8px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.7);
  min-width: 320px;
  max-width: 90vw;
  color: #e6edf3;
}
.modal-content h2 { margin-top: 0; }
.modal-content input[type="file"] { margin: 12px 0; }
.modal-content button { margin-top: 10px; }
/* styles.css */
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background:#0d1117; color:#e6edf3; margin:0;padding:8px; padding-top: 80px; }

header { 
  position: fixed; top: 0; left: 0; right: 0; 
  height: 70px; background: #161b22; 
  border-bottom: 1px solid #30363d; z-index: 1000;
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 20px;
}
.header-left h1 { margin: 0; font-size: 1.2rem; }
.header-left p { margin: 0; font-size: 0.8rem; color: #8b949e; }

#stickyPlayer { width: 400px; height: 50px; display: flex; align-items: center; justify-content: flex-end; }
#stickyPlayer iframe { border-radius: 4px; border: 1px solid #30363d; }
.player-placeholder { font-style: italic; color: #484f58; font-size: 0.9rem; margin-right: 10px; }

/* Control Layout */
#controls { margin: 16px; padding: 12px; background: #161b22; border-radius: 6px; border: 1px solid #30363d; }
.control-group { display: none; gap: 12px; align-items: center; }
#controls select, #controls input { margin-left:4px; padding:4px 6px; background: #0d1117; color: white; border: 1px solid #30363d; border-radius: 4px; }
button { cursor: pointer; background: #238636; color: white; border: none; padding: 5px 12px; border-radius: 4px; font-weight: bold; }
button:hover { background: #2ea043; }

/* View Switching Logic via Body Attribute */
body[data-view="overview"] .show-overview { display: flex; }
body[data-view="yearDeepDive"] .show-yearDeepDive { display: flex; }
body[data-view="artistDeepDive"] .show-artistDeepDive { display: flex; }

/* Layout */
main { display:flex; gap:12px; margin-top:12px; min-height: 500px; }
#chartArea { flex:1; background: #0d1117; border: 1px solid #30363d; border-radius:6px; overflow: hidden; position: relative; }
#details { width:320px; background:#161b22; padding:12px; border-radius:6px; border: 1px solid #30363d; display: flex; flex-direction: column; gap: 12px; }
#details h2 { margin-top:0; font-size: 1.1rem; border-bottom: 1px solid #30363d; padding-bottom: 8px; }

/* Components */
svg { display:block; }
.bar { fill: #1f6feb; transition: fill 0.2s; }
.bar.hover { fill: #e2b340; }
.artistLabel { fill:#c9d1d9; font-size:0.85rem; }
.label { fill:#8b949e; font-size:0.75rem; }

/* Deep Dive Lists */
.deep-list { list-style: none; padding: 0; margin: 0; }
.deep-list li { padding: 4px 8px; border-bottom: 1px solid #21262d; display: flex; justify-content: space-between; }
.deep-list li a { color: #58a6ff; text-decoration: none; }
.deep-list li a:hover { text-decoration: underline; }

/* Tooltip */
.tooltip { position:absolute; pointer-events:none; background:rgba(22,27,34,0.95); color:#c9d1d9; padding:8px 10px; border-radius:4px; font-size:0.85rem; border: 1px solid #30363d; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.5); }

/* Utility */
.placeholder { color: #8b949e; font-style: italic; }
iframe { border-radius: 6px; background: #000; }

/* Scrollbars */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-thumb { background: #30363d; border-radius: 5px; }
::-webkit-scrollbar-track { background: #0d1117; }